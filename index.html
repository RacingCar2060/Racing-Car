<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Auto Boutique</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous" />

  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

  <!-- Estilos personalizados -->
  <link rel="stylesheet" href="css/indexstyles.css" />
</head>
<body>
  <!-- HEADER -->
  <header class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold" href="#">AUTO BOUTIQUE</a>

      <div class="mx-auto d-flex align-items-center gap-3">
        <a href="index.html" class="btn btn-outline-light btn-sm">Inicio</a>
        <a href="html/tutoriales.html" class="btn btn-outline-light btn-sm">Tutoriales</a>
        <a href="html/quienessomos.html" class="btn btn-outline-light btn-sm">QuiÃ©nes somos</a>
      </div>

      <div class="d-flex align-items-center ms-4 gap-3">
        <!-- Login -->
        <a href="html/login.html" class="btn btn-outline-light btn-sm" title="Iniciar sesiÃ³n">
          <i class="bi bi-person fs-5"></i>
        </a>

        <!-- Carrito -->
        <a href="html/carrito.html" class="btn btn-outline-light btn-sm position-relative" title="Ver carrito">
          <i class="bi bi-cart fs-5"></i>
          <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">0</span>
        </a>
      </div>
    </div>
  </header>

  <!-- CARRUSEL PUBLICITARIO -->
  <div id="carouselPublicidad" class="carousel slide carrusel-pequeno shadow-lg rounded-3 overflow-hidden" data-bs-ride="carousel">
    <div class="carousel-inner">
      <div class="carousel-item active">
        <img src="https://images.unsplash.com/photo-1503376780353-7e6692767b70" class="d-block w-100" alt="Promo 1">
        <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
          <h5 class="fw-bold text-warning">Accesorios de Alta Gama</h5>
          <p>Potencia y estilo para tu auto.</p>
        </div>
      </div>
      <div class="carousel-item">
        <img src="https://images.unsplash.com/photo-1533473359331-0135ef1b58bf" class="d-block w-100" alt="Promo 2">
        <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
          <h5 class="fw-bold text-danger">IluminaciÃ³n LED</h5>
          <p>Conduce seguro con la mejor visibilidad.</p>
        </div>
      </div>
      <div class="carousel-item">
        <img src="https://images.unsplash.com/photo-1542362567-b07e54358753" class="d-block w-100" alt="Promo 3">
        <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
          <h5 class="fw-bold text-primary">Ofertas Especiales</h5>
          <p>Aprovecha descuentos exclusivos este mes.</p>
        </div>
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselPublicidad" data-bs-slide="prev">
      <span class="carousel-control-prev-icon"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselPublicidad" data-bs-slide="next">
      <span class="carousel-control-next-icon"></span>
    </button>
  </div>

  <!-- MAIN -->
  <main class="container mt-4">
    <div class="row">
      <!-- FILTROS -->
      <aside class="col-md-3">
        <h5>Filtrar por categorÃ­a</h5>
        <ul class="list-group" id="filtroCategorias">
          <!-- Cargado dinÃ¡micamente desde Firestore -->
        </ul>
      </aside>

      <!-- PRODUCTOS -->
      <section class="col-md-9">
        <input type="text" id="busqueda" class="form-control mb-3" placeholder="Buscar producto..." />
        <div id="productos" class="row"></div>

        <!-- PRODUCTOS DESTACADOS -->
        <h3 class="mt-5 mb-3">Productos Destacados</h3>
        <div class="row" id="destacados">
          <div class="col-md-6">
            <div class="card border-secondary destacado-card">
              <img src="https://vorlane.com/wp-content/uploads/2024/11/15Maintaining-LED-headlights-cleaning-for-longevity-and-optimal-performance.webp" class="card-img-top" alt="Promo destacada 1">
              <div class="card-body">
                <h5 class="card-title text-bold">Â¡50% de descuento en faros LED!</h5>
                <p class="card-text">VÃ¡lido hasta agotar stock.</p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card border-secondary destacado-card">
              <img src="https://http2.mlstatic.com/D_Q_NP_2X_630730-MPE77039148912_062024-T-juego-27-cepillos-detalles-auto-kit-detallado-taladro-autom.webp" class="card-img-top" alt="Promo destacada 2">
              <div class="card-body">
                <h5 class="card-title text-bold">Kit de limpieza GRATIS por compras mayores a S/500</h5>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>

  <!-- BOTONES FLOTANTES -->
  <div class="position-fixed bottom-0 end-0 m-4 d-flex flex-column gap-2 z-3">
    <a href="https://wa.me/981257739" class="btn btn-success rounded-circle" title="WhatsApp">
      <i class="bi bi-whatsapp"></i>
    </a>
    <a href="https://maps.app.goo.gl/5TMjc8iARGnqcyRd9" class="btn btn-primary rounded-circle" title="UbicaciÃ³n">
      <i class="bi bi-geo-alt"></i>
    </a>
    <button class="btn btn-dark rounded-circle" title="ChatBot">
      <i class="bi bi-robot"></i>
    </button>
    <button class="btn btn-secondary rounded-circle" title="Buscar por imagen" onclick="abrirBusquedaPorImagen()">
      <i class="bi bi-camera"></i>
    </button>
  </div>

  <!-- VENTANA DEL CHATBOT -->
  <div id="chatbot-window" class="card shadow-lg position-fixed bottom-0 end-0 m-5" style="width: 300px; display: none; z-index: 1050;">
    <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center">
      <span>ðŸ¤– Racing Bot</span>
      <button class="btn btn-sm btn-light" onclick="toggleChat()">âœ–</button>
    </div>
    <div class="card-body p-2" id="chatbot-messages" style="height: 250px; overflow-y: auto; font-size: 0.9rem;">
      <div class="text-muted small">Cargando...</div>
    </div>
    <div class="card-footer p-2 d-flex">
      <input type="text" id="chatbot-input" class="form-control form-control-sm me-2" placeholder="Escribe tu mensaje...">
      <button class="btn btn-sm btn-primary">âž¤</button>
    </div>
  </div>

  <!-- MODAL DETALLE -->
  <div class="modal fade" id="detalleModal" tabindex="-1" aria-labelledby="detalleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content border-0 shadow-lg">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="detalleModalLabel">ðŸ“Œ Detalle del Producto</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body p-4">
          <div class="row g-4">
            <div class="col-md-6 text-center">
              <img id="detalleImagen" src="" alt="Producto" class="img-fluid rounded-3 shadow-sm" style="max-height: 300px; object-fit: cover;">
            </div>
            <div class="col-md-6">
              <h4 id="detalleNombre" class="text-dark fw-bold"></h4>
              <p id="detalleDescripcion" class="text-muted lead mt-3"></p>
              <h5 id="detallePrecio" class="text-success mt-3 fs-4 fw-bold"></h5>
              <p id="detalleStock" class="mt-2 fs-5"></p>
              <button id="btnAgregarModal" class="btn btn-success mt-4 w-100 py-3 fs-5">
                <i class="bi bi-cart-plus"></i> Agregar al carrito
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CONTENEDORES OCULTOS PARA IA -->
  <div id="webcam-container" style="display:none; text-align:center; margin-top:20px;">
    <video id="webcam" autoplay playsinline style="width:300px; height:300px; border:2px solid #007bff; border-radius:10px;"></video>
    <button class="btn btn-danger btn-sm mt-2" onclick="detenerCamara()">Detener</button>
  </div>
  <canvas id="canvas" width="224" height="224" style="display:none;"></canvas>
  <div id="label-container" style="margin:15px auto; max-width:300px; font-family:Arial; text-align:center;"></div>

  <!-- FOOTER -->
  <footer class="footer-custom bg-dark text-white pt-5 pb-3 mt-5">
    <div class="container">
      <div class="row text-start">
        <div class="col-md-3 mb-4">
          <h5 class="fw-bold"><span class="text-gradient">AB</span> AUTO <span class="text-primary">BOUTIQUE</span></h5>
          <p class="small">Especialistas en accesorios automotrices de calidad. Tu vehÃ­culo merece lo mejor.</p>
          <div class="d-flex gap-3">
            <a href="#"><i class="bi bi-facebook text-white"></i></a>
            <a href="#"><i class="bi bi-instagram text-white"></i></a>
            <a href="#"><i class="bi bi-twitter text-white"></i></a>
          </div>
        </div>
        <div class="col-md-3 mb-4">
          <h6 class="text-danger fw-bold">Enlaces RÃ¡pidos</h6>
          <ul class="list-unstyled">
            <li><a href="#" class="text-white text-decoration-none">Inicio</a></li>
            <li><a href="#" class="text-white text-decoration-none">Tutoriales</a></li>
            <li><a href="#" class="text-white text-decoration-none">QuiÃ©nes Somos</a></li>
            <li><a href="#" class="text-white text-decoration-none">GarantÃ­as</a></li>
            <li><a href="#" class="text-white text-decoration-none">TÃ©rminos y Condiciones</a></li>
          </ul>
        </div>
        <div class="col-md-3 mb-4">
          <h6 class="text-danger fw-bold">CategorÃ­as</h6>
          <ul class="list-unstyled" id="footerCategorias"></ul>
        </div>
        <div class="col-md-3 mb-4">
          <h6 class="text-danger fw-bold">Contacto</h6>
          <ul class="list-unstyled">
            <li><i class="bi bi-telephone-fill me-2"></i> +51 965 849 410</li>
            <li><i class="bi bi-envelope-fill me-2"></i> racingaut307@gmail.com</li>
            <li><i class="bi bi-geo-alt-fill me-2"></i> Trujillo, PerÃº</li>
            <li><i class="bi bi-clock-fill me-2"></i> Lun - SÃ¡b: 9AM - 7PM</li>
          </ul>
        </div>
      </div>
      <div class="text-center mt-4">
        <h6 class="text-danger fw-bold">Mantente al dÃ­a</h6>
        <p class="small">Recibe noticias sobre nuevos productos y ofertas especiales</p>
        <form class="d-flex justify-content-center gap-2">
          <input type="email" class="form-control w-50 rounded-pill border-danger" placeholder="Tu email aquÃ­..." required />
          <button type="submit" class="btn btn-danger rounded-pill">Suscribirse</button>
        </form>
      </div>
      <div class="text-center mt-4 pt-3 border-top border-secondary small">
        &copy; 2024 AUTO BOUTIQUE RACING CAR S.A.C. Todos los derechos reservados.
      </div>
    </div>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
    crossorigin="anonymous"></script>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.13.0/firebase-app.js';
    import { getFirestore, collection, getDocs } from 'https://www.gstatic.com/firebasejs/10.13.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyCEKgW__Gfy9U3fOVzEOqyXgY682FYA3VU",
      authDomain: "autoboutique-racing-car.firebaseapp.com",
      projectId: "autoboutique-racing-car",
      storageBucket: "autoboutique-racing-car.firebasestorage.app",
      messagingSenderId: "573057463212",
      appId: "1:573057463212:web:973e8fe6b87d2180d84009",
      measurementId: "G-26FMZFW2TX"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    window.db = db;
    window.collection = collection;
    window.getDocs = getDocs;
  </script>

  <!-- TensorFlow.js y Teachable Machine -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@latest/dist/teachablemachine-image.min.js"></script>

  <!-- Scripts externos -->
  <script type="module" src="js/teachable.js"></script>
  <script src="js/chat.js"></script>
  <script type="module" src="js/catalogo.js"></script>

  <!-- NO HAY <script> FINAL: abrirBusquedaPorImagen() ya estÃ¡ en teachable.js -->
</body>
</html>